<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Match Out Game</title>
    <link href="../stylesheets/index.css" rel="stylesheet" type="text/css">
</head>
<body> 
    <h1>Find the Difference</h1>
   <h2 id="stats">
    <strong id="timer">time: 00:00</strong>    
    <strong id="errors">3</strong> lives
    </h2>
   <div id="testContainer" class="container"> 
       <img src="pic1.png" alt="" srcset="" width="100%" height="100%">
       <img src="pic1_diff.png" alt="" usemap="#pic_map" width="100%" height="100%">
       <map  name="pic_map">
           <area id="glove" alt="HERE!!" href="#" title="glove" shape="rect" coords="900,700,994,800" />
       </map>
       
    </div> 
    
    <!-- <script src="../image_resizer.js">

    </script> -->
    <script>
        let area = document.getElementById('glove');
        let entireContainer = document.getElementById('testContainer');
        let rect = area.getBoundingClientRect();
        entireContainer.addEventListener('click', (event) => {
            let clickedX = event.offsetX - rect.left;
            let clickedY = event.offsetY - rect.top;

            if (clickedX >= 900 && clickedX <= 994 && clickedY >= 700 && clickedY <= 800) {
                console.log("correct");
            } else {
                console.log("incorrect");
            }
        })
    </script>
    <script>
        //timer
        let timer = document.getElementById('timer')
        let seconds = 0
        let mins = 0
        setInterval( function() {
            seconds++ 
            timer.innerHTML = `${mins}:${seconds}`;
            if (seconds > 59){
                seconds = 0;
                mins++
            }

            timer.innerHTML = `${mins}:${seconds}`;
            seconds = pad(seconds);
            mins = pad(mins);
             function pad(unit){
                return (("0") + unit).length > 2 ? unit: "0" + unit
            }
        }, 1000)

        let errors = document.getElementById('errors')
        let lives = 3
        let correct_areas = Array.from(document.getElementsByTagName('button'))
        console.log("correct areas: ", correct_areas)
        let areasLeftUnclicked = correct_areas.length
        let game_image = document.getElementById('testContainer')
        let answers = []
        answers.push(document.getElementById('correct1'))

        game_image.addEventListener('click', function (click_event) {
            console.log(click_event.clientX, ":", click_event.clientY)
            console.log("image map worked")
            console.log(click_event)
            let clicked_position = (click_event.clientX, click_event.clientY)
            if (correct_areas.includes(clicked_position)){
                if (correct_areas.getAttribute('found') === 'true'){
                    console.log("you already clicked bum bum")
                    return true
                }else{
                    --areasLeftUnclicked
                    if(areasLeftUnclicked === 0){
                        window.location.href = "levelTwo.html"
                    }
                    console.log("correct answer found")
                }
                clicked_position.setAttribute('found', 'true')
            } else {
                console.log("wrong")
                lives = lives - 1
                errors.innerHTML = lives
                isGameOver()
            }
        })
        function isGameOver(){
                    if (lives === 0){
                    console.log("game over");
                    window.location.href = "../gameOver.html"
        }
    }
    </script>
</body>
</html>